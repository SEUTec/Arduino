Version 4
SHEET 1 1256 680
WIRE 32 32 -64 32
WIRE 256 32 160 32
WIRE -64 48 -64 32
WIRE 160 48 160 32
WIRE 672 48 656 48
WIRE 832 48 672 48
WIRE 992 48 912 48
WIRE 1136 48 992 48
WIRE 656 80 656 48
WIRE 992 80 992 48
WIRE 1136 80 1136 48
WIRE 480 96 480 80
WIRE -64 144 -64 128
WIRE 160 144 160 128
WIRE 224 192 80 192
WIRE 480 192 480 176
WIRE 80 208 80 192
WIRE 656 208 656 160
WIRE 992 208 992 144
WIRE 1136 208 1136 160
WIRE 80 304 80 288
FLAG -64 144 0
FLAG 80 304 0
FLAG 32 32 sine
FLAG 224 192 ramp
FLAG 480 192 0
FLAG 992 208 0
FLAG 1136 208 0
FLAG 1136 48 lp
FLAG 480 80 PWM
FLAG 160 144 0
FLAG 256 32 abs_sine
FLAG 656 208 0
FLAG 672 48 AC_PWM
SYMBOL voltage -64 32 R0
WINDOW 3 -2 -34 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value SINE(0 5 {fsen})
SYMATTR InstName V1
SYMBOL voltage 80 192 R0
WINDOW 3 -32 154 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 0 {Tpwm/2} {Tpwm/2} 0 {Tpwm})
SYMATTR InstName V2
SYMBOL bv 480 80 R0
WINDOW 3 -156 193 Left 2
SYMATTR Value V=if(V(abs_sine)>V(ramp),5,0)
SYMATTR InstName B1
SYMBOL res 1152 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 25 5 Left 2
SYMATTR InstName RLoad
SYMATTR Value 1k
SYMBOL cap 976 80 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL bv 160 32 R0
SYMATTR InstName B2
SYMATTR Value V=abs(V(sine))
SYMBOL bv 656 64 R0
WINDOW 3 -84 170 Left 2
SYMATTR Value V=if(V(sine)>0,V(PWM),-V(PWM))
SYMATTR InstName B3
SYMBOL ind 816 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 5m
SYMATTR SpiceLine Rser=0.1
TEXT 672 352 Left 2 !.tran {3/fsen}
TEXT 40 376 Left 2 !.param fsen=50 Fpwm={fsen*100}
TEXT 40 408 Left 2 !.param Tpwm=1/Fpwm
